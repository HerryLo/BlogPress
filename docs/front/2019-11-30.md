---
title: '小程序开发指南之性能优化'
data: 2019-11-30
tags: 小程序 个人指南
---
# 小程序开发指南之性能优化

[作者：HerryLo](https://github.com/HerryLo)

[原文永久链接： https://github.com/AttemptWeb/Record...]()

将从**代码层面**和**项目层面**，聊一聊微信小程序的性能优化问题，希望有所帮助。也是自己最近的一个总结。(微信小程序的视图层是WebView支持，逻辑层是JSCore支持，逻辑层通过setData与视图层发生交互。每一个页面都是一个WebView页面）

* [代码层面](#代码层面)
    * 拆分组件
    * 图片压缩
    * 减少不必要数据
    * 避免频繁setData
    * 使用webView组件开发
* [项目层面](#项目层面)
    * 拆分小程序
    * 分包预加载
    * 合理使用组件
    * 采取分包加载
    * 尽量升级版本库

## 代码层面

通过代码细节提升性能，而且在这方面，空间是非常大的。对于比较早期的小程序项目，由于代码细节方面没有过多的考虑，也导致了开发出的小程序非常的消耗性能。下面将提到的一些点，不论是正在开发的项目，还是在维护的项目，都会有一定的帮助。

### 👇· 拆分组件

对于小程序的项目，由于野蛮式开发，不会太多的考虑组件拆分。当然对于关注组件开发的公司，肯定会在早期就做好一定的规划。做好组件的拆分，可以保证组件的复用，大量的减少重复的代码。（**组件开发的思想，目前基本适用所有的前端开发项目**）。如何有效拆分组件方法，详见[]()。

### 👇· 图片压缩

在微信小程序项目中，不会在本地存放图片，基本都是网络图片，而网络图片的下载，需要消耗一定的时间和内存。较小图片的大小，可以提升小程序的渲染时间，减少内存的占用。通过**CDN静态资源服务器获取图片资源，添加图片压缩规则**，可以极大的提升性能。

### 👇· 减少不必要数据

### 👇· 避免频繁setData

```javascript
// 微信小程序
this.setData({
    count: 1
})
this.setData({
    count: 2
})
this.setData({
    count: 3
})
```
三次```setData```会被全部触发嘛？是的，会被全部调用。在微信小程序中，并不像react，把多次操作合并。每次setData的过程，就是一次JSCore逻辑层 和 webView视图层的交互。过多的交互，会降低小程序的用户体验。例如 滑动监听滚动，操作setData，非常的消耗性能，可以考虑使用节流函数，降低调用频率。

官方给出的建议是：**每秒setData不要超过20次**。来修改一下上面的代码。

```javascript
// 推荐 合并操作
let data = { count: 1 }
data.count = 2;
data.count = 3;
this.setData(data)
```

### 👇· 使用webView组件开发

更多内容：

['小程序个人开发指南](https://didiheng.com/front/2019-07-22.html)

ps: 微信公众号：Yopai，有兴趣的可以关注，每周不定期更新，分享可以增加世界的快乐

![](/webChat1.png)